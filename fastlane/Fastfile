default_platform(:android)

platform :android do
  desc "Upload AAB to Play Store internal testing track"
  lane :internal do
    upload_to_play_store(
      track: 'internal',
      aab: 'build/app/outputs/bundle/release/app-release.aab',
      skip_upload_metadata: true,
      skip_upload_images: true,
      skip_upload_screenshots: true
    )
  end

  desc "Upload metadata (screenshots, descriptions) to Play Store"
  lane :metadata do
    upload_to_play_store(
      skip_upload_aab: true,
      skip_upload_apk: true
    )
  end

  desc "Upload AAB to Play Store production track"
  lane :production do
    upload_to_play_store(
      track: 'production',
      aab: 'build/app/outputs/bundle/release/app-release.aab'
    )
  end

  desc "Upload everything (AAB + metadata) to internal track"
  lane :deploy_internal do
    upload_to_play_store(
      track: 'internal',
      aab: 'build/app/outputs/bundle/release/app-release.aab'
    )
  end

  desc "Validate service account credentials"
  lane :validate do
    validate_play_store_json_key(
      json_key: 'android/play-store-credentials.json'
    )
  end
end
